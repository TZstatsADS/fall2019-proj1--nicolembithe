---
title: "DataStory"
author: "Nicole Mbithe"
date: "9/19/2019"
output: ioslides_presentation

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r message=FALSE, warning=FALSE, paged.print=FALSE}

library(reticulate)
py_install("nltk")
py_install("pandas")
py_install("wordcloud")
string<- import("string")
```

```{python}
import string
import nltk 
import matplotlib
from nltk.sentiment.vader import SentimentIntensityAnalyzer
#nltk.download('punkt')
#nltk.download('stopwords')
#nltk.download('vader_lexicon')
from nltk.corpus import stopwords
en_stopwords = set(stopwords.words('english')) 
import pandas as pd
```

```{python}
lyrics = pd.read_csv("data/lyrics.csv")
lyrics.head()
```
```{python}
#Helper function to help clean the data
def preprocess(v):
    
    #tokenize the sentences
    x = nltk.word_tokenize(v)
    
    #remove punctuation
    x = [word for word in x if word not in string.punctuation]
    
    #remove stopwords
    x = [word.lower() for word in x if word not in  en_stopwords]
    
    return x

#Also want to get the sentiment score for each song based on the sentences in the song and add a column with
sid = SentimentIntensityAnalyzer()
def get_sentiments(v):
    
    #get the sentences in the song
    x = nltk.sent_tokenize(v)
    
    #get the seniment score for the each sentence and track the max and the min
    max_sent = -float('inf')
    min_sent = float('inf')
    
    for sentence in x:
        score = sid.polarity_scores(sentence)['compound']
        max_sent = score if score > max_sent else max_sent
        min_sent = score if score < min_sent else min_sent

    
    return pd.Series([max_sent, min_sent], index=['max_sent', 'min_sent'])
    
#get the sentiment scores for each song
lyrics = pd.concat([lyrics, lyrics['lyrics'].apply(get_sentiments)], axis = 1)

#get the cleaned words from the song lyrics
lyrics['lyrics'] = lyrics['lyrics'].apply(preprocess)
lyrics.year = lyrics.year.replace({702: 1998, 112:2002})
lyrics['year'] = pd.to_datetime(lyrics['year'], format = "%Y")
```

## Slide with Bullets
```{python}
lyrics.head()
```

```{python}
from collections import Counter
Folk = lyrics[(lyrics.genre == 'Folk')]
Jazz = lyrics[(lyrics.genre == 'Jazz')]
Hip_Hop = lyrics[(lyrics.genre == 'Hip-Hop')]
R_n_B = lyrics[(lyrics.genre == 'R&B')]
Pop = lyrics[(lyrics.genre == 'Pop')][['genre', 'lyrics']]
Metal = lyrics[(lyrics.genre == 'Metal')]

```{python}
Folk = lyrics[(lyrics.genre == 'Folk')]
Jazz = lyrics[(lyrics.genre == 'Jazz')]
Hip_Hop = lyrics[(lyrics.genre == 'Hip-Hop')]
R_n_B = lyrics[(lyrics.genre == 'R&B')]
Pop = lyrics[(lyrics.genre == 'Pop')][['genre', 'lyrics']]
Metal = lyrics[(lyrics.genre == 'Metal')]

#generate a list from the lyrics with the frequencies of each word
#store them in a dictionary
word_could_dict=Counter(my_list)
wordcloud = WordCloud(max_font_size=50, max_words=100, background_color="white").generate_from_frequencies(word_could_dict)
plt.figure()
plt.imshow(wordcloud, interpolation="bilinear")
plt.axis("off")
plt.show()
```
```


- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}
summary(cars)
```

## Slide with Plot

```{r pressure}
plot(pressure)
```

